{% extends "base.html" %}
{% block title %}豆瓣电影 - 数据可视化看板{% endblock %}

{% block content %}
<!-- 巨幕 (Hero Section) -->
<div class="row mb-5">
  <div class="col-12">
    <div class="p-5 text-white rounded-3 shadow-sm"
      style="background: linear-gradient(135deg, #1f2937 0%, #111827 100%); position: relative; overflow: hidden;">
      <!-- Decorative circle -->
      <div
        style="position: absolute; top: -50px; right: -50px; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%;">
      </div>

      <div class="position-relative z-1">
        <h1 class="display-5 fw-bold mb-3">探索电影数据的奥秘</h1>
        <p class="lead mb-4 text-light opacity-75">基于 Python 爬虫与 AI 算法的非官方豆瓣电影可视化分析平台。</p>
        <div class="input-group input-group-lg shadow-sm" style="max-width: 600px;">
          <span class="input-group-text bg-white border-0 text-muted"><i class="bi bi-search"></i></span>
          <!-- 携带查询参数跳转到搜索页 -->
          <input type="text" class="form-control border-0" placeholder="搜索电影、导演或演员..." id="searchInput"
            data-search-url="{{ url_for('search') }}"
            onkeydown="if(event.key==='Enter'){window.location.href=this.dataset.searchUrl+'?q='+this.value}">
          <button class="btn btn-primary px-4" type="button"
            onclick="const input = document.getElementById('searchInput'); window.location.href=input.dataset.searchUrl+'?q='+input.value">搜索</button>
        </div>
        <div class="mt-3 small text-white-50">
          热门搜索: <a href="{{ url_for('search', q='诺兰') }}"
            class="text-white-50 text-decoration-none hover-white me-2">诺兰</a>
          <a href="{{ url_for('search', q='肖申克') }}" class="text-white-50 text-decoration-none hover-white me-2">肖申克</a>
          <a href="{{ url_for('search', q='喜剧') }}" class="text-white-50 text-decoration-none hover-white">喜剧</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 关键指标卡片 (KPI Cards) -->
<div class="row g-4 mb-5">
  <div class="col-xl-3 col-md-6">
    <div class="card border-0 shadow-sm h-100 overflow-hidden">
      <div class="card-body position-relative">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="bg-primary bg-opacity-10 text-primary rounded-3 p-3">
            <i class="bi bi-film fs-4"></i>
          </div>
          <span class="badge bg-success bg-opacity-10 text-success rounded-pill">+{{ stats.total }} This week</span>
        </div>
        <h3 class="fw-bold mb-1">{{ stats.total }}</h3>
        <span class="text-muted small">累计收录影片</span>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-0 shadow-sm h-100">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="bg-warning bg-opacity-10 text-warning rounded-3 p-3">
            <i class="bi bi-star-fill fs-4"></i>
          </div>
        </div>
        <h3 class="fw-bold mb-1">{{ stats.avg_score }}</h3>
        <span class="text-muted small">平均评分 (Avg Score)</span>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-0 shadow-sm h-100">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="bg-success bg-opacity-10 text-success rounded-3 p-3">
            <i class="bi bi-trophy-fill fs-4"></i>
          </div>
        </div>
        <h3 class="fw-bold mb-1">{{ stats.high_score }}</h3>
        <span class="text-muted small">9.0+ 高分佳作</span>
      </div>
    </div>
  </div>

  <div class="col-xl-3 col-md-6">
    <div class="card border-0 shadow-sm h-100">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="bg-info bg-opacity-10 text-info rounded-3 p-3">
            <i class="bi bi-calendar-range fs-4"></i>
          </div>
        </div>
        <h3 class="fw-bold mb-1">{{ stats.years }} <span class="fs-6 text-muted fw-normal">年</span></h3>
        <span class="text-muted small">时间跨度</span>
      </div>
    </div>
  </div>
</div>

</div>

<!-- 功能导航网格 -->
<div class="row mb-4">
  <div class="col-12 mb-3">
    <h5 class="fw-bold text-gray-800 border-start border-4 border-primary ps-3">功能导航</h5>
  </div>
</div>

<div class="row g-4 mb-5">
  <!-- 多维分析 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('analysis') }}"
      class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-primary bg-opacity-10 text-primary mx-auto mb-3">
          <i class="bi bi-pie-chart-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">多维数据分析</h6>
        <p class="text-muted small mb-0">包含产地地图、类型分布饼图等可视化图表。</p>
      </div>
    </a>
  </div>

  <!-- AI 聚类 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('cluster_page') }}"
      class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-info bg-opacity-10 text-info mx-auto mb-3">
          <i class="bi bi-diagram-3-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">AI 语义聚类</h6>
        <p class="text-muted small mb-0">基于 K-Means 与 TF-IDF 的电影剧情聚类分析。</p>
      </div>
    </a>
  </div>

  <!-- 动态词云 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('analysis') }}"
      class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-warning bg-opacity-10 text-warning mx-auto mb-3">
          <i class="bi bi-cloud-haze2-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">动态词云</h6>
        <p class="text-muted small mb-0">分析电影高频关键词，生成可视化词云图。</p>
      </div>
    </a>
  </div>

  <!-- 全部电影 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('movie') }}" class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-success bg-opacity-10 text-success mx-auto mb-3">
          <i class="bi bi-collection-play-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">电影列表</h6>
        <p class="text-muted small mb-0">浏览所有已收录的电影详细信息。</p>
      </div>
    </a>
  </div>

  <!-- 后台管理 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('admin') }}" class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-secondary bg-opacity-10 text-secondary mx-auto mb-3">
          <i class="bi bi-gear-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">后台管理</h6>
        <p class="text-muted small mb-0">管理数据源、运行爬虫及检查系统状态。</p>
      </div>
    </a>
  </div>

  <!-- 关于项目 -->
  <div class="col-md-4 col-sm-6">
    <a href="{{ url_for('aboutMe') }}"
      class="card h-100 border-0 shadow-sm text-decoration-none feature-card hover-lift">
      <div class="card-body text-center p-4">
        <div class="icon-circle bg-danger bg-opacity-10 text-danger mx-auto mb-3">
          <i class="bi bi-info-circle-fill fs-3"></i>
        </div>
        <h6 class="fw-bold text-dark">关于项目</h6>
        <p class="text-muted small mb-0">了解项目架构、技术栈及开发团队。</p>
      </div>
    </a>
  </div>
</div>

<style>
  .icon-circle {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .hover-lift {
    transition: transform 0.2s;
  }

  .hover-lift:hover {
    transform: translateY(-5px);
  }

  .hover-white:hover {
    color: #fff !important;
  }
</style>
{% endblock %}